import*as Utils_String from"../Core/Util/String";var SubjectType,IdentitySeparators;function getUniquefiedIdentityName(t){var E,I,i;return t?(E=t.signInAddress||t.samAccountName||t.mail||t.originId,isEntraIDIdentity(t)?(i=(I=Utils_String.equals(t.entityType,"Group",!0))?IdentitySeparators.AAD_IDENTITY_GROUP_PREFIX:IdentitySeparators.AAD_IDENTITY_USER_PREFIX,!t.signInAddress&&!t.mail||I?Utils_String.format("{0} {1}{2}{3}{4}",t.displayName,IdentitySeparators.AAD_IDENTITY_UNIQUEFIEDNAME_SEPERATOR_START,i,t.originId,IdentitySeparators.AAD_IDENTITY_UNIQUEFIEDNAME_SEPERATOR_END):Utils_String.format("{0} {1}{2}{3}\\{4}{5}",t.displayName,IdentitySeparators.AAD_IDENTITY_UNIQUEFIEDNAME_SEPERATOR_START,i,t.originId,t.signInAddress||t.mail,IdentitySeparators.AAD_IDENTITY_UNIQUEFIEDNAME_SEPERATOR_END)):isTfsGroup(t)?t.localId?Utils_String.format("{0} {1}{2}{3}{4}",t.displayName,IdentitySeparators.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_START,IdentitySeparators.TFS_GROUP_PREFIX,t.localId.toUpperCase(),IdentitySeparators.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_END):t.displayName||"":E?-1===E.indexOf("@")&&t.scopeName&&!isServicePrincipal(t)?Utils_String.format("{0} {1}{2}\\{3}{4}",t.displayName,IdentitySeparators.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_START,t.scopeName,E,IdentitySeparators.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_END):Utils_String.format("{0} {1}{2}{3}",t.displayName,IdentitySeparators.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_START,E,IdentitySeparators.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_END):t.subjectDescriptor?Utils_String.format("{0} {1}{2}{3}{4}",t.displayName,IdentitySeparators.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_START,IdentitySeparators.DESCRIPTOR_PREFIX,t.subjectDescriptor,IdentitySeparators.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_END):t.displayName||""):""}function isEntraIDIdentity(t){return Utils_String.equals(t.originDirectory,"aad",!0)&&!!t.originId&&!t.localId}function isServicePrincipal(t){return!!t.subjectDescriptor&&t.subjectDescriptor.startsWith(SubjectType.EntraIDServicePrincipal)}function isTfsGroup(t){var E;return!!t.displayName&&(E=t.displayName.indexOf("\\"),Utils_String.equals(t.entityType,"Group",!0))&&Utils_String.startsWith(t.displayName,"[")&&-1!==E&&Utils_String.endsWith(t.displayName.substring(0,E),"]")}!function(t){t.EntraIDUser="aad",t.EntraIDGroup="aadgp",t.EntraIDServicePrincipal="aadsp"}(SubjectType=SubjectType||{}),function(t){t.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_START="<",t.IDENTITY_UNIQUEFIEDNAME_SEPERATOR_END=">",t.AAD_IDENTITY_UNIQUEFIEDNAME_SEPERATOR_START="<<",t.AAD_IDENTITY_UNIQUEFIEDNAME_SEPERATOR_END=">>",t.TFS_GROUP_PREFIX="id:",t.AAD_IDENTITY_USER_PREFIX="user:",t.AAD_IDENTITY_GROUP_PREFIX="group:",t.IDENTITY_UNIQUENAME_SEPARATOR="\\",t.DESCRIPTOR_PREFIX="desc:"}(IdentitySeparators=IdentitySeparators||{});export{SubjectType,IdentitySeparators,getUniquefiedIdentityName,isEntraIDIdentity};