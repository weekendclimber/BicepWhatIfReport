import{announce}from"../../Core/Util/Accessibility";import{cellFromEvent}from"../../List";import*as Resources from"../../Resources.Widgets";import{KeyCode}from"../../Util";import{SortOrder}from"./Table.Props";var ColumnSorting=function(){function e(e){var o=this;this.isSizerSortingFixFFEnabled=!1,this.initialize=function(e,t,n){o.props=e,(o.eventDispatch=n).addEventListener("click",o.onClick),n.addEventListener("keydown",o.onKeyDown),o.isSizerSortingFixFFEnabled=document.body.classList.contains("sizer-sorting-fix-ff-enabled")},this.componentDidMount=function(e){o.props=e},this.componentDidUpdate=function(e){o.props=e},this.componentWillUnmount=function(){o.eventDispatch&&(o.eventDispatch.removeEventListener("click",o.onClick),o.eventDispatch.removeEventListener("keydown",o.onKeyDown))},this.onClick=function(e){e.defaultPrevented||o.processSortEvent(e,!0)},this.onKeyDown=function(e){e.defaultPrevented||e.which!==KeyCode.enter&&e.which!==KeyCode.space||o.processSortEvent(e)},this.onSort=e}return e.prototype.processSortEvent=function(e,t){var n;if(!this.isSizerSortingFixFFEnabled||"true"!==document.body.getAttribute("data-resize-active")&&"false"!==document.body.getAttribute("data-resize-active")){var o=cellFromEvent(e),r=e.target,i=!t&&r.classList.contains("bolt-table-header-cell-actionable");if(!r.classList.contains("bolt-table-header-sizer")){for(;!i&&r!==o.cellElement&&r.parentElement;)i=(r=r.parentElement).classList.contains("bolt-table-header-cell-actionable");-1===o.rowIndex&&i&&(t=this.props.columns[o.cellIndex])&&t.sortProps&&(this.onSort(o.cellIndex,t.sortProps.sortOrder===SortOrder.ascending?SortOrder.descending:SortOrder.ascending,e),t=t.sortProps.sortOrder===SortOrder.ascending?null!=(n=t.sortProps.ariaLabelAscending)?n:Resources.ColumnSortedAscendingAnnouncement:null!=(n=t.sortProps.ariaLabelDescending)?n:Resources.ColumnSortedDescendingAnnouncement,announce(t,!0),e.preventDefault())}}},e}();function sortItems(n,e,o,t,r){var i=o[n];i&&e===SortOrder.descending&&(i=function(e,t){return-o[n](e,t)});for(var s=0;s<t.length;s++){var c=t[s];c.sortProps&&(c.sortProps.sortOrder=s===n?e:void 0)}return i?r.sort(i):r}export{ColumnSorting,sortItems};